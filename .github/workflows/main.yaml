name: Compile & Release Linux-TKG 6.6 LTS

on:
  push:
    branches:
      - '6.6-latest-tkg'

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 360
    container:
      image: archlinux:latest
      options: --privileged

    steps:
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 0. Generar tag dinÃ¡mico (fecha + short SHA)
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "01 - Generate release tag"
        id: tag
        run: |
          TAG="v6.6-$(date +'%Y%m%d')-$(echo ${{ github.sha }} | cut -c1-7)"
          echo "tag=$TAG" >> $GITHUB_OUTPUT
          echo "Tag generado: $TAG"

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 1. Checkout del repo propio
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "02 - Checkout lauta-dev/linux-tkg"
        uses: actions/checkout@v4
        with:
          repository: 'lauta-dev/linux-tkg'
          ref: '6.6-latest-tkg'
          path: 'myrepo'

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 2. Debug: mostrar paths reales del container
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "03 - Debug paths"
        run: |
          echo "github.workspace = ${{ github.workspace }}"
          echo "PWD = $(pwd)"
          echo "HOME = $HOME"
          echo "=== Contenido de PWD ==="
          ls -la
          echo "=== Contenido de myrepo ==="
          ls -la myrepo/ 2>/dev/null || echo "myrepo/ no encontrado desde PWD"
          echo "=== Buscando modprobed.db ==="
          find / -name "modprobed.db" 2>/dev/null || echo "No encontrado"

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 3. Cache de paquetes de pacman
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "04 - Cache pacman packages"
        uses: actions/cache@v4
        with:
          path: /var/cache/pacman/pkg
          key: pacman-v1
          restore-keys: |
            pacman-

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 4. Dependencias del sistema (ccache incluido)
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "05 - Install System Tools"
        run: |
          pacman-key --init
          pacman-key --populate archlinux
          pacman -Syu --noconfirm --needed \
            git base-devel sudo \
            xmlto kmod inetutils bc libelf \
            python pahole cpio perl tar xz zstd \
            ccache wget \
            docbook-xsl patchutils \
            python-sphinx python-sphinx_rtd_theme \
            graphviz imagemagick \
            clang llvm lld

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 5. Checkout de Frogging-Family/linux-tkg
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "06 - Checkout Frogging-Family/linux-tkg"
        uses: actions/checkout@v4
        with:
          repository: 'Frogging-Family/linux-tkg'
          path: 'linux-tkg'

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 6. Cache del tarball del kernel 6.6
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "07 - Cache kernel source tarball"
        uses: actions/cache@v4
        with:
          path: linux-tkg/linux-src-git
          key: kernel-src-6.6-${{ hashFiles('myrepo/customization.cfg') }}
          restore-keys: |
            kernel-src-6.6-

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 7. Setup: modprobed.db + customization.cfg
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "08 - Setup modprobed.db and config"
        run: |
          # Copiar a /home/runner/ (ruta hardcodeada en customization.cfg)
          mkdir -p /home/runner/
          cp myrepo/modprobed.db /home/runner/modprobed.db
          # Copiar tambiÃ©n a $HOME por si TKG lo busca ahÃ­
          mkdir -p $HOME/.config/
          cp myrepo/modprobed.db $HOME/.config/modprobed.db
          cp myrepo/customization.cfg linux-tkg/customization.cfg
          echo "âœ… modprobed.db â†’ /home/runner/modprobed.db"
          echo "âœ… modprobed.db â†’ $HOME/.config/modprobed.db"
          echo "âœ… customization.cfg â†’ linux-tkg/"

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 8. Enforce critical configs
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "09 - Enforce critical configs"
        run: |
          mkdir -p linux-tkg/linux66-tkg-userpatches
          FRAG="linux-tkg/linux66-tkg-userpatches/config-fragment.cfg"

          printf '%s\n' \
            '# Video / pantalla gris fix' \
            'CONFIG_FB=y' \
            'CONFIG_VT=y' \
            'CONFIG_VT_CONSOLE=y' \
            'CONFIG_FRAMEBUFFER_CONSOLE=y' \
            'CONFIG_DRM_FBDEV_EMULATION=y' \
            'CONFIG_FB_EFI=y' \
            'CONFIG_FONT_8x16=y' \
            'CONFIG_FONT_SUPPORT=y' \
            '# WiFi RTL8723BE - ambos drivers' \
            'CONFIG_CFG80211=m' \
            'CONFIG_MAC80211=m' \
            'CONFIG_WLAN_VENDOR_REALTEK=y' \
            'CONFIG_RTL8723BE=m' \
            'CONFIG_RTL8723_COMMON=m' \
            'CONFIG_RTLWIFI=m' \
            'CONFIG_RTLWIFI_PCI=m' \
            '# CONFIG_RTW88 deshabilitado â€” NOT SET en 6.6 base' \
            '# Namespaces' \
            'CONFIG_USER_NS=y' \
            'CONFIG_NAMESPACES=y' \
            'CONFIG_NET_NS=y' \
            'CONFIG_PID_NS=y' \
            '# ZRAM' \
            'CONFIG_ZRAM=m' \
            'CONFIG_ZSMALLOC=y' \
            'CONFIG_ZRAM_DEF_COMP_LZ4=y' \
            > "$FRAG"

          echo "=== config-fragment.cfg ==="
          cat "$FRAG"

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 9. Cache ccache
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "10 - Cache ccache objects"
        uses: actions/cache@v4
        with:
          path: /tmp/ccache
          key: ccache-kernel-6.6-${{ hashFiles('myrepo/customization.cfg') }}-${{ github.sha }}
          restore-keys: |
            ccache-kernel-6.6-${{ hashFiles('myrepo/customization.cfg') }}-
            ccache-kernel-6.6-

      - name: "11 - Configure ccache"
        run: |
          mkdir -p /tmp/ccache
          ccache --dir /tmp/ccache --max-size=5G
          ccache --dir /tmp/ccache --zero-stats
          echo "PATH=/usr/lib/ccache/bin:$PATH" >> $GITHUB_ENV
          echo "CCACHE_DIR=/tmp/ccache" >> $GITHUB_ENV

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 10. Crear builduser (makepkg no puede correr como root)
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "12 - Create build user"
        run: |
          useradd --no-create-home builduser
          mkdir -p /home/builduser
          echo "builduser ALL=(ALL) NOPASSWD: ALL" > /etc/sudoers.d/builduser
          chown -R builduser:builduser /__w/linux-tkg/linux-tkg/linux-tkg
          chown -R builduser:builduser /__w/linux-tkg/linux-tkg/myrepo
          # modprobed.db en home de builduser
          cp /home/runner/modprobed.db /home/builduser/modprobed.db
          mkdir -p /home/builduser/.config
          cp /home/runner/modprobed.db /home/builduser/.config/modprobed.db
          chown -R builduser:builduser /home/builduser
          # Dar acceso a /tmp/ccache al builduser
          mkdir -p /tmp/ccache
          chown -R builduser:builduser /tmp/ccache
          # Actualizar path en customization.cfg
          sed -i 's|_modprobeddb_db_path=".*"|_modprobeddb_db_path="/home/builduser/modprobed.db"|' /__w/linux-tkg/linux-tkg/linux-tkg/customization.cfg
          echo "âœ… builduser creado"
          echo "âœ… modprobed.db â†’ /home/builduser/modprobed.db"
          grep "_modprobeddb_db_path" /__w/linux-tkg/linux-tkg/linux-tkg/customization.cfg

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 11. Debug workspace
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "12b - Debug workspace structure"
        run: |
          echo "=== PWD ==="
          pwd
          echo "=== /__w/ ==="
          ls -la /__w/ 2>/dev/null || echo "no existe"
          echo "=== /__w/linux-tkg/ ==="
          ls -la /__w/linux-tkg/ 2>/dev/null || echo "no existe"
          echo "=== /__w/linux-tkg/linux-tkg/ ==="
          ls -la /__w/linux-tkg/linux-tkg/ 2>/dev/null || echo "no existe"
          echo "=== /__w/linux-tkg/linux-tkg/linux-tkg/ ==="
          ls -la /__w/linux-tkg/linux-tkg/linux-tkg/ 2>/dev/null || echo "no existe"
          echo "=== /__w/linux-tkg/linux-tkg/linux-tkg/src/ ==="
          ls -la /__w/linux-tkg/linux-tkg/linux-tkg/src/ 2>/dev/null || echo "no existe"
          echo "=== /__w/linux-tkg/linux-tkg/linux-tkg/src/linux-src-git/ (top level) ==="
          ls -la /__w/linux-tkg/linux-tkg/linux-tkg/src/linux-src-git/ 2>/dev/null | head -20 || echo "no existe"
          echo "=== Buscando .config en todo src/ ==="
          find /__w/linux-tkg/linux-tkg/linux-tkg/src -name ".config" 2>/dev/null || echo "ninguno"
          echo "=== Buscando *.pkg.tar.zst ==="
          find /__w -name "*.pkg.tar.zst" 2>/dev/null || echo "ninguno"

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 12. Fetch source (sin compilar) para poder parcharlo
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "13 - Fetch kernel source (nobuild)"
        run: |
          sudo -E -u builduser bash -c "
            cd /__w/linux-tkg/linux-tkg/linux-tkg
            yes '' | makepkg --nobuild --noconfirm --skippgpcheck
          " || true

          echo "=== Estructura de src/ post-fetch ==="
          ls -la /__w/linux-tkg/linux-tkg/linux-tkg/src/ 2>/dev/null || echo "src/ no existe"
        env:
          MAKEFLAGS: "-j$(nproc)"
          CCACHE_DIR: /tmp/ccache

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 13. Patch libbpf.c â€” fix const qualifier bug
      #     Bug: char *next_path deberÃ­a ser const char *next_path
      #     Error: -Werror=discarded-qualifiers en GCC moderno con kernel 6.6
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "14 - Patch libbpf.c const qualifier bug"
        if: false
        run: |
          LIBBPF=$(find /__w/linux-tkg/linux-tkg/linux-tkg/src \
            -path "*/resolve_btfids/libbpf/libbpf.c" 2>/dev/null | head -1)

          if [ -z "$LIBBPF" ]; then
            echo "âŒ libbpf.c no encontrado â€” listando src/ para debug:"
            find /__w/linux-tkg/linux-tkg/linux-tkg/src -maxdepth 5 -type f -name "*.c" 2>/dev/null | head -20
            exit 1
          fi

          echo "âœ… libbpf.c encontrado en: $LIBBPF"
          echo "=== LÃ­neas con next_path ANTES del patch ==="
          grep -n "next_path" "$LIBBPF" | head -10

          # Patch: cambiar 'char *next_path' a 'const char *next_path'
          # Solo modifica la declaraciÃ³n, no los usos
          sed -i 's/^\(\s*\)char \*next_path;/\1const char *next_path;/' "$LIBBPF"

          echo "=== LÃ­neas con next_path DESPUÃ‰S del patch ==="
          grep -n "next_path" "$LIBBPF" | head -10
          echo "âœ… Patch aplicado correctamente"

          # Re-asignar permisos para que builduser pueda compilar
          chown builduser:builduser "$LIBBPF"

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 14. CompilaciÃ³n completa (--noextract para conservar el patch)
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "15 - Compile Kernel"
        run: |
          JOBS=$(nproc)
          echo "Compilando con $JOBS cores"
          export MAKEFLAGS="-j${JOBS}"
          export CCACHE_DIR=/tmp/ccache
          sudo -E -u builduser bash -c "
            cd /__w/linux-tkg/linux-tkg/linux-tkg
            yes '' | makepkg --noconfirm --skippgpcheck --noextract
          "

      - name: "16 - Show ccache stats"
        if: always()
        run: sudo -u builduser ccache --show-stats
        env:
          CCACHE_DIR: /tmp/ccache

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 15. Buscar y preparar paquetes para el release
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "17 - Collect and stage packages"
        if: always()
        run: |
          echo "=== Buscando .pkg.tar.zst ==="
          find /__w -name "*.pkg.tar.zst" 2>/dev/null || echo "ninguno"
          mkdir -p linux-tkg/output
          find /__w/linux-tkg/linux-tkg/linux-tkg -maxdepth 1 -name "*.pkg.tar.zst" \
            -exec cp {} linux-tkg/output/ \; 2>/dev/null || true
          echo "=== Paquetes en linux-tkg/output/ ==="
          ls -la linux-tkg/output/ 2>/dev/null || echo "ninguno"

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # 16. Crear Release
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: "18 - Create GitHub Release"
        uses: softprops/action-gh-release@v2
        with:
          tag_name: ${{ steps.tag.outputs.tag }}
          name: "Linux-TKG 6.6 LTS â€” ${{ steps.tag.outputs.tag }}"
          body: |
            ## ðŸ§ Linux-TKG 6.6 LTS â€” Compilado para Intel Celeron N2807 (Bay Trail)

            ### ðŸ–¥ï¸ Hardware Target
            | Campo | Valor |
            |---|---|
            | CPU | Intel Celeron N2807 @ 2.17 GHz (Silvermont) |
            | GPU | Intel Atom Z36xxx/Z37xxx (i915) |
            | RAM | 3.72 GiB |
            | WiFi | Realtek RTL8723BE |
            | OS | EndeavourOS / Arch-based |

            ### âš™ï¸ ConfiguraciÃ³n del Kernel
            | Flag | Valor |
            |---|---|
            | VersiÃ³n | 6.6-latest (LTS) |
            | Arquitectura | `silvermont` |
            | Scheduler | `bore` |
            | Timer | 1000 Hz |
            | CPU Governor | `performance` |
            | Mitigaciones | deshabilitadas |
            | modprobed.db | âœ… activado |
            | Debug symbols | âŒ deshabilitado |
            | Strip | âœ… activado |

            ### ðŸ“¦ MÃ³dulos clave incluidos
            - **Video:** `i915`, `drm`, `ttm`, framebuffer console, EFI framebuffer
            - **WiFi:** `rtl8723be`, `rtlwifi`, `rtw88_8723be` (legacy + moderno)
            - **Audio:** `snd_hda_intel` + codec Realtek
            - **Storage:** `ahci`, `sd_mod`, `ext4`, `f2fs`, `ntfs3`
            - **USB 3.0:** `xhci_hcd`, `xhci_pci`
            - **Bluetooth:** `btusb`, `btintel`
            - **ZRAM:** `zram` + `lz4`
            - **TÃ©rmica:** `processor_thermal_*`, `intel_soc_dts_*`

            ### ðŸ“¥ InstalaciÃ³n
            ```bash
            # Descargar los .pkg.tar.zst del release y ejecutar:
            sudo pacman -U linux-tkg-*.pkg.tar.zst linux-tkg-headers-*.pkg.tar.zst

            # Actualizar bootloader (GRUB):
            sudo grub-mkconfig -o /boot/grub/grub.cfg
            ```

            > âš ï¸ **Nota:** Este kernel estÃ¡ optimizado especÃ­ficamente para el N2807.
            > Las mitigaciones de CPU estÃ¡n deshabilitadas para maximizar rendimiento.
            > No instalar en hardware diferente sin recompilar.
          files: linux-tkg/output/*.pkg.tar.zst
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
